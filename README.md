# 1C_VK
Библиотека интеграции 1С и ВКонтакте

В данной библиотеке реализовано множество методов для работы с ВКонтакте из 1С посредством VK API 

Документация VK API:
https://dev.vk.com/ru/method

## Для начала использования библиотеки достаточно пройти два простых шага: ##
<details>
<summary>Установка библиотеки</summary>
<br>
Библиотека представляет из себя всего два общих модуля

  
- **Инструменты** - содержит вспомогательные методы, вроде отправки http запросов, чтения JSON и пр.
- **Действия**    - непосредственно сами методы работы с VK
  
Эти модули необходимо добавить в свою конфигурацию (модули серверные). При переименовании модуля **Инструменты** необходимо будет провести рефакторинг в модуле **Действия**. Модуль же **Действия** можно переименовывать без изменений.
После установки можно просто вызывать нужные методы из модуля **Действия**
</details>

<details>
<summary>Получение необходимых данных</summary>
<br>
Перед началом работы необходимо получить некоторые параметры для VK API. Их перечень содержится в функции ПолучитьСтандартныеПараметры
<br><br>
После получения их можно вставить в эту функцию и все будет работать. Если же вы хотите передавать эти параметры каждый раз при вызове (например разные для нескольких сообществ), то это можно сделать через параметр Параметры, который есть у каждого метода.
При вызове, параметры заполняются из функции ПолучитьСтандартныеПараметры, после чего перезаписываются по ключам значениями, переданными в параметр "Параметры"
<br><br>
 
  ```
  _Параметры = Новый Структура;

  _Параметры.Вставить("v"	              , "5.131");
  _Параметры.Вставить("from_group"      , "1");
_Параметры.Вставить("group_id"        , "123456789");
  _Параметры.Вставить("owner_id"        , "-123456789");
  _Параметры.Вставить("app_id"          , "87654321");
_Параметры.Вставить("access_token"    , "vk1.a.E-byuFeG1qcN7...");
	
  ```

Рассмотрим получение каждого значения:

**1. v**
   
   Параметр v означает версию VK API. Тестирование проводилось на 5.131, рекомендуется его таким и оставить

**2. from_group**

   От лица группы. Должен быть 1

**3. group_id и owner_id**

   ID группы. Если у вас стандартный адрес группы, то id можно найти в URL. В противном случае он будет на вкладке "Управление" в группе, под полем Адрес. owner_id - тоже самое, но со знаком '-' впереди

**4. app_id**

   app_id - ID приложения. Для создания приложения необходимо:
   
  * Перейти по адресу https://vk.com/apps?act=manage, авторизоваться и нажать "Создать"
  * Выбрать название и пункт Standalone-приложение
  * После создания, перейти в редактирование на вкладку Настройки, забрать оттуда ID приложения (и есть app_id), и переключить статус на "Приложение включено и видно всем"
  * Сохранить изменения

**5. access_token**

  acess_token можно получить при помощи одного из методов модуля **Действия**:
  
  * Выполнить _СоздатьСсылкуПолученияТокена(app_id)_, Передав туда ID приложения из пункта 5
  * Метод вернет URL, по нему необходимо перейти в браузере
  * Авторизоваться через ВК и подтвердить
  * Забрать токен из параметра URL в адресной строке
   
</details>

## Реализованные методы: ##
<details>
<summary>Для управления контентом в группе</summary>
<br>
Эти методы предназначены для создания/удаления/редактирования контента в сообществе

* __Создание поста | Метод: СоздатьПост()__
  
  | Параметр | Тип | Назначение |
  |-|-|-|
  | Текст | Строка | Непосредственно текст поста |
  | МассивКартинок | Массив строк (путей к файлам), Массив Двоичных данных | Массив картинок, которые необходимо прикрепить к посту |
  | Рекламный | Булево (По умолчанию Ложь) | Пометить пост как рекламу |
  | СсылкаПодЗаписью | Строка (По умолчанию "") | Позволяет прикрепить ссылку к посту |
  | Параметры | Структура (по умолчанию нет) | Дополнительные параметры / перезапись стандартных параметров |
  
</details>
